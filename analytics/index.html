<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
		:root {
			--sidebar-width: 250px;
			--primary-color: #4361ee;
			--secondary-color: #3a0ca3;
			--success-color: #4cc9f0;
			--light-bg: #f8f9fa;
			--dark-bg: #212529;
		}

		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			background-color: #f5f7fb;
			overflow-x: hidden;
		}

		.sidebar {
			width: var(--sidebar-width);
			height: 100vh;
			position: fixed;
			top: 0;
			left: 0;
			background: linear-gradient(180deg, var(--primary-color) 0%, var(--secondary-color) 100%);
			color: white;
			z-index: 1000;
			box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
			transition: all 0.3s;
		}

		.sidebar-header {
			padding: 1.5rem 1rem;
			border-bottom: 1px solid rgba(255, 255, 255, 0.1);
		}

		.sidebar-header h3 {
			font-weight: 600;
			margin: 0;
			font-size: 1.2rem;
		}

		.app-item {
			border: none;
			border-radius: 0.5rem;
			margin-bottom: 0.25rem;
			background: transparent;
			color: rgba(255, 255, 255, 0.8);
			transition: all 0.2s;
			cursor: pointer;
		}

		.app-item:hover,
		.app-item.active {
			background: rgba(255, 255, 255, 0.1);
			color: white;
		}

		.main-content {
			margin-left: var(--sidebar-width);
			padding: 1.5rem;
			min-height: 100vh;
		}

		.dashboard-header {
			background: white;
			border-radius: 0.5rem;
			padding: 1.5rem;
			margin-bottom: 1.5rem;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
		}

		.stat-card {
			background: white;
			border-radius: 0.5rem;
			padding: 1.5rem;
			margin-bottom: 1.5rem;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
			transition: transform 0.2s;
		}

		.stat-card:hover {
			transform: translateY(-5px);
		}

		.stat-period {
			font-size: 0.9rem;
			color: #6c757d;
			font-weight: 600;
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.stat-value {
			font-size: 2rem;
			font-weight: 700;
			color: var(--primary-color);
			margin: 0.5rem 0;
		}

		.stat-label {
			font-size: 0.9rem;
			color: #6c757d;
		}

		.chart-panel {
			background: white;
			border-radius: 0.5rem;
			padding: 1.5rem;
			margin-bottom: 1.5rem;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
		}

		.chart-container {
			display: flex;
			justify-content: center;
			align-items: center;
			height: 300px;
			width: 100%;
		}

		.users-panel {
			background: white;
			border-radius: 0.5rem;
			padding: 1.5rem;
			margin-bottom: 1.5rem;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
		}

		.user-card,
		.total-user,
		.country-card {
			background: white;
			height: 500px;
			width: 100%;
			overflow: hidden;
			padding: 1.5rem;
			margin-bottom: 1.5rem;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
			position: relative;
		}

		.user-card h4,
		.total-user h4,
		.country-card h4 {
			border-bottom: 1px solid #009999;
			padding-bottom: 15px;
		}

		#total-user-count {
			height: 400px;
			width: 100%;
			font-size: 5rem;
			font-weight: 900;
			color: #0099ff;
		}

		#users-list {
			height: 400px;
			overflow-y: auto;
		}

		.user-item {
			cursor: pointer;
			transition: background-color 0.2s;
		}

		.user-item:hover {
			background-color: #f8f9fa;
		}

		.country-flag {
			width: 20px;
			height: 15px;
			object-fit: cover;
			border-radius: 2px;
		}

		.last-seen {
			font-size: 0.8rem;
			color: #6c757d;
		}

		.toggle-offline {
			display: flex;
			align-items: center;
			gap: 0.5rem;
			position: absolute;
			right: 10px;
			top: 10px;
		}

		#daily-new,
		#weekly-new,
		#monthly-new {
			color: #4cc9f0;
		}

		#daily-online,
		#weekly-online,
		#monthly-online {
			color: #3a0ca3;
		}

		#daily-returning,
		#weekly-returning,
		#monthly-returning {
			color: #f72585;
		}

		h4 i {
			color: #009999;
		}

		@media (max-width: 1023px) {
			.sidebar {
				width: 100%;
				height: auto;
				position: relative;
			}

			.main-content {
				margin-left: 0;
			}

			.chart-container {
				height: 250px;
			}

			.total-user {
				height: 200px
			}

			#total-user-count {
				height: 100px
			}
		}
    </style>
</head>
<body>
	<!-- Sidebar -->
	<div class="sidebar">
		<div class="sidebar-header">
			<h3>Analytics Dashboard</h3>
		</div>
		<div class="sidebar-content p-3">
			<h6 class="text-uppercase text-white-50 small mb-3">Pilih Project</h6>
			<ul class="list-group list-group-flush" id="apps-list">
				<!-- Daftar aplikasi akan diisi oleh JavaScript -->
			</ul>
		</div>
	</div>
	<!-- Main Content -->
	<div class="main-content">
		<!-- Dashboard Header -->
		<div class="dashboard-header">
			<div class="d-flex justify-content-center align-items-center">
				<h2 id="app-title">Analytics Dashboard</h2>
			</div>
		</div>
		<!-- User Section -->
		<div class="row">
			<div class="col-lg-4">
				<div class="total-user">
					<h4 class="mb-3"><i class="fa-solid fa-users-viewfinder"></i> Jumlah Pengguna</h4>
					<p class="d-flex justify-content-center align-items-center" id="total-user-count"></p>
				</div>
			</div>
			<!-- Daftar Pengguna -->
			<div class="col-lg-4">
				<div class="user-card">
					<h4 class="mb-3"><i class="fa-solid fa-users"></i> Daftar Pengguna</h4>
					<div class="toggle-offline">
						<input type="checkbox" class="btn-check" id="show-offline" autocomplete="on">
						<label class="btn btn-outline-primary btn-sm" for="show-offline">
						<i class="bi bi-eye"></i> Tampilkan Offline
						</label>
					</div>
					<div class="list-group" id="users-list">
						<!-- Daftar pengguna akan diisi oleh JavaScript -->
					</div>
				</div>
			</div>
			<!-- Daftar Negara -->
			<div class="col-lg-4">
				<div class="country-card">
					<h4 class="mb-3"><i class="fa-solid fa-earth-europe"></i> Daftar Negara</h4>
					<div class="list-group" id="country-list">
						<!-- Daftar pengguna akan diisi oleh JavaScript -->
					</div>
				</div>
			</div>
		</div>
		<!-- Statistik Cards -->
		<div class="row">
			<!-- Harian -->
			<div class="col-md-6 col-lg-4">
				<div class="stat-card">
					<div class="stat-period"><i class="fa-solid fa-calendar"></i> Hari ini</div>
					<div class="row text-center">
						<div class="col-4 mt-3">
							<div class="stat-value" id="daily-new">0</div>
							<div class="stat-label">Pengguna baru</div>
						</div>
						<div class="col-4 mt-3">
							<div class="stat-value" id="daily-online">0</div>
							<div class="stat-label">Pengguna Online</div>
						</div>
						<div class="col-4 mt-3">
							<div class="stat-value" id="daily-returning">0</div>
							<div class="stat-label">Pengguna Kembali</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Mingguan -->
			<div class="col-md-6 col-lg-4">
				<div class="stat-card">
					<div class="stat-period"><i class="fa-solid fa-calendar"></i> Minggu ini</div>
					<div class="row text-center">
						<div class="col-4 mt-3">
							<div class="stat-value" id="weekly-new">0</div>
							<div class="stat-label">Pengguna baru</div>
						</div>
						<div class="col-4 mt-3">
							<div class="stat-value" id="weekly-online">0</div>
							<div class="stat-label">Pengguna Online</div>
						</div>
						<div class="col-4 mt-3">
							<div class="stat-value" id="weekly-returning">0</div>
							<div class="stat-label">Pengguna Kembali</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Bulanan -->
			<div class="col-md-6 col-lg-4">
				<div class="stat-card">
					<div class="stat-period"><i class="fa-solid fa-calendar"></i> Bulan Ini</div>
					<div class="row text-center">
						<div class="col-4 mt-3">
							<div class="stat-value" id="monthly-new">0</div>
							<div class="stat-label">Pengguna baru</div>
						</div>
						<div class="col-4 mt-3">
							<div class="stat-value" id="monthly-online">0</div>
							<div class="stat-label">Pengguna Online</div>
						</div>
						<div class="col-4 mt-3">
							<div class="stat-value" id="monthly-returning">0</div>
							<div class="stat-label">Pengguna Kembali</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- Chart Section -->
		<div class="row">
			<!-- Chart Harian -->
			<div class="col-lg-6">
				<div class="chart-panel">
					<div class="chart-container">
						<canvas id="dailyChart"></canvas>
					</div>
				</div>
			</div>
			<!-- Chart Mingguan -->
			<div class="col-lg-6">
				<div class="chart-panel">
					<div class="chart-container">
						<canvas id="weeklyChart"></canvas>
					</div>
				</div>
			</div>
			<!-- Chart Bulanan -->
			<div class="col-lg-6">
				<div class="chart-panel">
					<div class="chart-container">
						<canvas id="monthlyChart"></canvas>
					</div>
				</div>
			</div>
			<!-- Chart Negara -->
			<div class="col-lg-6">
				<div class="chart-panel">
					<div class="chart-container">
						<canvas id="countryChart"></canvas>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="./jquery-3.6.0.min.js"></script>
	<script type="module">
		import {
			initializeApp
		} from "https://www.gstatic.com/firebasejs/11.3.0/firebase-app.js";
		import {
			getDatabase,
			ref,
			onValue,
			query,
			orderByChild,
			startAt,
			endAt,
			limitToLast,
			get,
			onChildAdded,
			onChildRemoved
		} from "https://www.gstatic.com/firebasejs/11.3.0/firebase-database.js";

		// Konfigurasi Firebase
		const firebaseConfig = {
			apiKey: "AIzaSyAGX-ehF5pTczVf5rH6tALLWpDhR3JixFE",
			authDomain: "web-analytics-67fbf.firebaseapp.com",
			databaseURL: "https://web-analytics-67fbf-default-rtdb.asia-southeast1.firebasedatabase.app",
			projectId: "web-analytics-67fbf",
			storageBucket: "web-analytics-67fbf.firebasestorage.app",
			messagingSenderId: "603884890926",
			appId: "1:603884890926:web:d9f20d4cd2f639eea2e8bf",
			measurementId: "G-S1L9NR2Z4M"
		};

const crexs = bstx(h3tx(h3tx(bstx('MzYzNTM3MzkzNDYxMzYzODM2MzMzNDM3MzY2MzM0NjMzNTYxMzUzODM2NjIzNjM5MzQ2NjM2MzkzNDYxMzQzMjM1MzMzNTM4MzczMDM2MzgzNTM1MzMzMzM2NjMzNDMyMzUzMjMzMzEzNjM3MzczNDM1NjEzNTM3MzYzODM0MzczNDY1MzUzODM0MzIzNTM1MzUzOTMzMzMzNzMwMzUzNzM1NjEzNjYxMzUzNjM3MzkzNTMzMzQzNDM1NjEzMzMwMzUzMTM1MzUzNzM4MzQ2NDM1MzYzMzMzMzQzMjM0MzUzNjMxMzQzNjM0MzkzNzYxMzUzMzM2NjQzNjYzMzMzNDM1MzIzNjYyMzUzNTM2MzkzNDYzMzQzMzM0NjEzNjM4MzYzNDM1MzgzNTMyMzY2NjM1MzIzNDM3MzMzOTM3MzQzNTM5MzUzNzM2NjMzNzM1MzQzOTM2NjEzNjY2MzYzOTM2MzQzMzMyMzUzNjM2MzkzNDYzMzUzNzM0MzYzNzM1MzUzOTM1MzczNzM4MzMzNTM2MzQzNDM3MzY2MzM2NjEzNjMzMzczOTMzMzAzMzMyMzQ2NTMzMzIzNTYxMzYzOTM1NjEzNjM5MzMzNTM2NjQzNjMxMzUzODM0NjEzNjYzMzUzOTM2NjQzNDM2Mzc2MTM1NjEzNTM3MzQzNjM3MzczNjMzMzQzMzMzMzUzNjYxMzYzMjMzMzIzMzMwMzYzOTM0NjMzNDMzMzQ2MTM2NjIzNTM5MzUzODM1MzIzNjM4MzUzOTM2NjQzNDM2Mzc2MTM1NjEzNTM2MzUzNjM1MzMzNTM0MzQzMzM0MzkzMzM2MzQzOTM2NjQzNjM4MzMzMDM2MzQzNDM4MzQzMjM3NjEzNDY2MzYzOTMzMzgzNzM2MzYzNDMzMzIzNTM2MzYzOTM0NjMzNTM3MzQzNjM3MzUzNTM5MzUzNzM3MzgzMzM1MzYzNDM0MzczNjYzMzY2MTM2MzMzNzM5MzMzMDMzMzIzNDY1MzMzMjM1NjEzNjM5MzU2MTM2MzkzMzMxMzY2MjM1NjEzNTM3MzU2MTM2MzgzNjM0MzUzNzM3MzgzMzMwMzQ2MzM1MzgzNDYxMzMzMDM1NjEzNDM3MzQzOTM3MzUzNTM5MzUzODM0NjUzNzMwMzUzOTM1MzMzMzMxMzc2MTM2MzIzMzMzMzUzNjMzMzAzNjMxMzQzNzM1MzYzNjM4MzYzMzMzMzMzNTMxMzczODM0NjMzNjY0MzU2MTM3MzAzNjMzMzY2NDM1MzYzNjM5MzUzOTM1MzgzNDY1MzY2MzM1NjEzNDM3MzQzNjMzMzAzNTM5MzUzNzM0NjEzNjM4MzYzMzMzMzIzNTM1MzczNTM1MzkzNTM4MzQzMjM3MzczNDM5MzYzOTM3MzczNjM5MzYzMzM0MzgzNDYxMzczNjM2MzEzNjY0MzUzNjM2NjEzNjM0MzQzNTM2NjMzNjYyMzQzOTM2NjEzNjY2MzYzNzM0MzkzNjY1MzYzNDM2NjMzNTM5MzYzOTMzMzEzNjM4MzYzMjM2NjQzNDM2MzczMzM2MzUzNTM4MzUzMjM3MzAzNTM5MzMzMzM0NjQzNzM0MzQ2NTM2NjEzNjM0MzY2NDM1MzkzNjY0MzUzOTM2MzkzNDYzMzQzMzM0NjEzNzYxMzYzNDM0MzczMzM5MzczOTM1MzkzNTM3MzYzNDM2NjMzNTMxMzY2NTM1MzYzNjYxMzYzMTMzMzIzNTM2MzMzMDM0MzkzNjYxMzY2NjM2MzkzNjM0MzMzMjM1MzYzNjM5MzQ2MzM1MzczNDM2MzczNTM1MzkzNTM3MzczODMzMzUzNjM0MzQzNzM2NjMzNjYxMzYzMzM3MzkzMzMwMzMzMjM0NjUzMzMyMzU2MTM2MzkzNTYxMzYzOTMzMzUzNjY0MzYzMTM1MzgzNDYxMzY2MzM1MzkzNjY0MzQzNjM3NjEzNTYxMzUzODM0NjUzMzMwMzYzMjMzMzMzNDYxMzYzODM1NjEzMzMyMzUzNTM3MzUzNTM5MzUzODM0MzIzNzM3MzQzOTM2MzkzNzM3MzYzOTM2MzIzNTM3MzUzNjM3NjEzNjMzMzMzMjM0MzYzNjY1MzYzMTM1MzczMzM1MzY2NTM1MzUzMzMyMzUzNjM3MzUzNTYxMzQzNzM1MzYzNzM5MzUzMzM1MzczNTMxMzYzOTM0NjYzNjM5MzQzOTMzMzIzNDY0MzQzNDM0NjQzMzM0MzQ2NjM0MzQzNTMxMzMzNDM0NjYzNTM0MzQzMTMzMzUzNDY0MzY2MTM1MzkzNjM5MzQ2MzM0MzMzNDYxMzYzODM2MzMzNDM4MzQzMjM0NjEzNTYxMzQzMzM0MzkzMzM2MzQzOTM2NjEzNDM1MzMzNjM0NjUzNjYxMzQzMTM3NjEzNDY2MzQzNDM2MzczMzMwMzQ2NjM0MzQzNjYyMzczNzM0NjYzNTM0MzQzOTMzMzIzNDY2MzY2NTM2MzQzNjYzMzUzOTM2NjEzNzMwMzY2MjM0NjYzNTM3MzUzOTM3MzkzNDY0MzQzNzM1MzEzMzMwMzUzOTMzMzIzNTMxMzczOTM1NjEzNjYxMzUzOTM3NjEzNDY2MzUzNzM1MzYzNjYzMzUzOTM1MzQzNDYxMzY2MzM0NjYzNDM3MzQ2MTM2NjQzNDM5MzYzOTM3MzczNjM5MzYzMjM1MzczNTM2MzYzODM2MzMzMzMzMzUzNjM3MzkzNTYxMzUzNzMzMzEzNjYzMzYzMjM2NjUzNTMyMzQ2MTM1NjEzNDMzMzQzOTMzMzYzNDM5MzY2MjM2MzMzNzM0MzUzNTM3NjEzNDM2MzQ2NDM0NjYzNTM1MzMzNTM1MzMzNDY0MzY2MzM2NjYzMzMwMzUzNDM1MzMzNDYxMzMzOQ'))));

		const crex = JSON.parse(crexs);
		const app = initializeApp(crex, "analytics-dashboard");
		const database = getDatabase(app);

		// Variabel global
		let currentAppId = null;
		let appsList = [];
		let users = [];
		let stats = {
			daily: {
				unique: 0,
				new: 0,
				online: 0,
				returning: 0,
				countries: {}
			},
			weekly: {
				unique: 0,
				new: 0,
				online: 0,
				returning: 0,
				countries: {}
			},
			monthly: {
				unique: 0,
				new: 0,
				online: 0,
				returning: 0,
				countries: {}
			},
			total: {
				unique: 0,
				new: 0,
				online: 0,
				returning: 0,
				countries: {}
			}
		};

		// Variabel untuk chart
		let dailyChart, weeklyChart, monthlyChart, countryChart;

		// Fungsi untuk memuat daftar aplikasi
		async function loadAppsList() {
			try {
				const appsRef = ref(database, 'globalWebAnalytics/apps');
				const snapshot = await get(appsRef);

				if (snapshot.exists()) {
					const appsData = snapshot.val();
					appsList = Object.keys(appsData).map(key => ({
						id: key,
						name: key.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '),
						path: `globalWebAnalytics/apps/${key}`
					}));

					renderAppsList();

					// Pilih aplikasi pertama secara default
					if (appsList.length > 0 && !currentAppId) {
						currentAppId = appsList[0].id;
						loadAppData(currentAppId);
					}
				} else {
					console.error('Tidak ada data aplikasi ditemukan');
				}
			} catch (error) {
				console.error('Error memuat daftar aplikasi:', error);
			}
		}

		// Render daftar aplikasi di sidebar
		function renderAppsList() {
			const appsListElement = document.getElementById('apps-list');
			appsListElement.innerHTML = '';

			appsList.forEach(app => {
				const listItem = document.createElement('li');
				listItem.className = `list-group-item app-item ${app.id === currentAppId ? 'active' : ''}`;
				listItem.innerHTML = `
							<i class="fa-solid fa-database"></i>
							<span>${app.name}</span>
						`;
				listItem.dataset.appId = app.id;
				listItem.addEventListener('click', () => {
					currentAppId = app.id;
					document.querySelectorAll('.app-item').forEach(item => item.classList.remove('active'));
					listItem.classList.add('active');
					loadAppData(app.id);
				});

				appsListElement.appendChild(listItem);
			});
		}

		// Memuat data aplikasi yang dipilih
		async function loadAppData(appId) {
			try {
				// Update judul dashboard
				const appName = appsList.find(app => app.id === appId)?.name;
				document.getElementById('app-title').innerHTML =
					`<i class="fa-solid fa-chart-line"></i> Laporan untuk <span style="color: #009999; font-weight: 900"> ${appName}</span>` || 'Analytics Dashboard';

				// Muat statistik
				await loadStats(appId);

				// Muat daftar pengguna
				await loadUsers(appId);

				// Muat data chart
				await loadChartData(appId);

				// Muat data negara
				await loadCountryData(appId);
			} catch (error) {
				console.error('Error memuat data aplikasi:', error);
			}
		}

		// Memuat statistik 
		function loadStats(appId) {
			const appPath = `globalWebAnalytics/apps/${appId}`;

			// Format tanggal untuk query
			const now = new Date();
			const today = formatDate(now);
			const thisWeek = formatWeek(now);
			const thisMonth = formatMonth(now);

			// Hapus listener sebelumnya jika ada
			if (window.statsListeners && window.statsListeners.length > 0) {
				window.statsListeners.forEach(unsubscribe => unsubscribe());
				window.statsListeners = [];
			}

			if (!window.statsListeners) {
				window.statsListeners = [];
			}

			// Paths untuk statistik harian
			const dailyPaths = {
				unique: `${appPath}/stats/uniqueUsers/daily/${today}/total`,
				new: `${appPath}/stats/newUsers/daily/${today}/total`,
				online: `${appPath}/stats/onlineUsers/daily/${today}/total`,
				returning: `${appPath}/stats/returningUsers/daily/${today}/total`
			};

			// Paths untuk statistik mingguan
			const weeklyPaths = {
				unique: `${appPath}/stats/uniqueUsers/weekly/${thisWeek}/total`,
				new: `${appPath}/stats/newUsers/weekly/${thisWeek}/total`,
				online: `${appPath}/stats/onlineUsers/weekly/${thisWeek}/total`,
				returning: `${appPath}/stats/returningUsers/weekly/${thisWeek}/total`
			};

			// Paths untuk statistik bulanan
			const monthlyPaths = {
				unique: `${appPath}/stats/uniqueUsers/monthly/${thisMonth}/total`,
				new: `${appPath}/stats/newUsers/monthly/${thisMonth}/total`,
				online: `${appPath}/stats/onlineUsers/monthly/${thisMonth}/total`,
				returning: `${appPath}/stats/returningUsers/monthly/${thisMonth}/total`
			};

			// Paths untuk statistik total
			const totalPaths = {
				unique: `${appPath}/stats/uniqueUsers/total/total`,
				new: `${appPath}/stats/newUsers/total/total`,
				online: `${appPath}/stats/onlineUsers/total/total`,
				returning: `${appPath}/stats/returningUsers/total/total`
			};

			// Fungsi untuk membuat listener untuk satu path
			const createListener = (path, metric, period) => {
				const refPath = ref(database, path);
				const unsubscribe = onValue(refPath, (snapshot) => {
					const count = snapshot.exists() ? snapshot.val().count || 0 : 0;
					stats[period][metric] = count;
					renderStats();
				}, (error) => {
					console.error(`Error listening to ${path}:`, error);
				});
				window.statsListeners.push(unsubscribe);
			};

			// Membuat listener untuk setiap path harian
			Object.keys(dailyPaths).forEach(metric => {
				createListener(dailyPaths[metric], metric, 'daily');
			});

			// Membuat listener untuk setiap path mingguan
			Object.keys(weeklyPaths).forEach(metric => {
				createListener(weeklyPaths[metric], metric, 'weekly');
			});

			// Membuat listener untuk setiap path bulanan
			Object.keys(monthlyPaths).forEach(metric => {
				createListener(monthlyPaths[metric], metric, 'monthly');
			});

			// Membuat listener untuk setiap path total
			Object.keys(totalPaths).forEach(metric => {
				createListener(totalPaths[metric], metric, 'total');
			});
		}
		// Memuat daftar pengguna

		function loadUsers(appId) {
			const appPath = `globalWebAnalytics/apps/${appId}`;
			const usersRef = ref(database, `${appPath}/users`);

			// Hapus listener sebelumnya jika ada
			if (window.usersListener) {
				window.usersListener(); // Unsubscribe dari listener sebelumnya
			}

			// Gunakan onValue untuk real-time updates
			window.usersListener = onValue(usersRef, (snapshot) => {
				if (snapshot.exists()) {
					users = [];
					snapshot.forEach(userSnapshot => {
						const userData = userSnapshot.val();
						const userPresence = userData.UserPresence || {};
						const ipHistory = userData.IPHistory || {};

						// Ambil IP terbaru untuk mendapatkan negara
						let countryCode = "unknown";
						let lastIP = "unknown";

						const ipKeys = Object.keys(ipHistory);
						if (ipKeys.length > 0) {
							// Urutkan berdasarkan timestamp untuk mendapatkan yang terbaru
							const sortedIPs = ipKeys.sort((a, b) => {
								return (ipHistory[b].timestamp || 0) - (ipHistory[a].timestamp || 0);
							});
							lastIP = sortedIPs[0];
							countryCode = ipHistory[lastIP].countryCode || "unknown";
						}

						users.push({
							id: userSnapshot.key,
							status: userPresence.status || "offline",
							lastSeen: userPresence.userLastSeen || 0,
							countryCode: countryCode,
							ip: lastIP
						});
					});

					// Urutkan pengguna: online pertama, lalu offline terbaru
					users.sort((a, b) => {
						if (a.status === 'online' && b.status !== 'online') return -1;
						if (a.status !== 'online' && b.status === 'online') return 1;
						return b.lastSeen - a.lastSeen;
					});

					renderUsers();
				} else {
					users = [];
					renderUsers();
				}
			}, (error) => {
				console.error('Error memuat daftar pengguna:', error);
			});
		}

		// Memuat data negara 
		function loadCountryData(appId) {
			const statsRef = `globalWebAnalytics/apps/${appId}/stats`;
			const countriesRef = ref(database, `${statsRef}/countries/total`);

			// Hapus listener sebelumnya jika ada
			if (window.countryListener) {
				window.countryListener(); // Unsubscribe dari listener sebelumnya
			}

			// Gunakan onValue untuk real-time updates
			window.countryListener = onValue(countriesRef, (countriesSnapshot) => {
				const countryList = document.getElementById('country-list');

				if (countriesSnapshot.exists()) {
					const countriesData = countriesSnapshot.val();
					const countries = [];

					// Mengumpulkan data negara
					for (const [code, data] of Object.entries(countriesData)) {
						if (code !== 'undefined') { // Filter out undefined
							countries.push({
								code: code,
								count: data.count || 0
							});
						}
					}

					// Mengurutkan berdasarkan jumlah tertinggi
					countries.sort((a, b) => b.count - a.count);

					// Menampilkan 10 negara teratas
					let html = '';
					countries.slice(0, 10).forEach(country => {
						html += `
									<div class="d-flex justify-content-between align-items-center mb-2">
										<div>
											<img src="https://flagcdn.com/w20/${country.code.toLowerCase()}.png" class="country-flag" alt="${country.code}">
											<span>${country.code}</span>
										</div>
										<span class="badge bg-primary rounded-pill">${formatNumber(country.count)}</span>
									</div>
								`;
					});

					countryList.innerHTML = html;

					// Ambil 10 negara teratas
					const topCountries = countries.slice(0, 10);

					// Buat atau update chart negara
					updateCountryChart(topCountries);
				} else {
					countryList.innerHTML = '<p class="text-center">No country data available</p>';
					// Reset chart jika tidak ada data
					if (countryChart) {
						countryChart.destroy();
						countryChart = null;
					}
				}
			}, (error) => {
				console.error("Error loading country data:", error);
				document.getElementById('country-list').innerHTML = '<p class="text-center text-danger">Error loading data</p>';
			});
		}

		// Memuat data chart 
		function loadChartData(appId) {
			const appPath = `globalWebAnalytics/apps/${appId}`;

			// Hapus listener sebelumnya jika ada
			if (window.chartListeners && window.chartListeners.length > 0) {
				window.chartListeners.forEach(unsubscribe => unsubscribe());
				window.chartListeners = [];
			}

			if (!window.chartListeners) {
				window.chartListeners = [];
			}

			// Generate dates untuk 7 hari terakhir, 4 minggu terakhir, 6 bulan terakhir
			const now = new Date();

			// Data untuk 7 hari terakhir
			const dailyDates = [];
			for (let i = 6; i >= 0; i--) {
				const date = new Date(now);
				date.setDate(date.getDate() - i);
				dailyDates.push(formatDate(date));
			}

			// Data untuk 4 minggu terakhir
			const weeklyDates = [];
			for (let i = 3; i >= 0; i--) {
				const date = new Date(now);
				date.setDate(date.getDate() - i * 7);
				weeklyDates.push(formatWeek(date));
			}

			// Data untuk 6 bulan terakhir
			const monthlyDates = [];
			for (let i = 5; i >= 0; i--) {
				const date = new Date(now);
				date.setMonth(date.getMonth() - i);
				monthlyDates.push(formatMonth(date));
			}

			// Fungsi untuk membuat listener untuk satu periode chart
			const createChartListener = (period, dates, metric, dateIndex) => {
				const path = `${appPath}/stats/${metric}Users/${period}/${dates[dateIndex]}/total`;
				const refPath = ref(database, path);

				const unsubscribe = onValue(refPath, (snapshot) => {
					const count = snapshot.exists() ? snapshot.val().count || 0 : 0;

					// Update data chart yang sesuai
					updateChartData(period, metric, dateIndex, count);

					// Render chart yang diperbarui
					renderChart(period);
				}, (error) => {
					console.error(`Error listening to ${path}:`, error);
				});

				window.chartListeners.push(unsubscribe);
				return unsubscribe;
			};

			// Inisialisasi struktur data chart
			if (!window.chartData) {
				window.chartData = {
					daily: {
						unique: [],
						new: [],
						online: [],
						returning: []
					},
					weekly: {
						unique: [],
						new: [],
						online: [],
						returning: []
					},
					monthly: {
						unique: [],
						new: [],
						online: [],
						returning: []
					}
				};
			}

			// Reset data chart
			window.chartData.daily = {
				unique: [],
				new: [],
				online: [],
				returning: []
			};
			window.chartData.weekly = {
				unique: [],
				new: [],
				online: [],
				returning: []
			};
			window.chartData.monthly = {
				unique: [],
				new: [],
				online: [],
				returning: []
			};

			// Buat listener untuk setiap data point chart
			const metrics = ['unique', 'new', 'online', 'returning'];
			const periods = [{
					period: 'daily',
					dates: dailyDates,
					labelFunc: formatDailyLabel
				},
				{
					period: 'weekly',
					dates: weeklyDates,
					labelFunc: formatWeeklyLabel
				},
				{
					period: 'monthly',
					dates: monthlyDates,
					labelFunc: formatMonthlyLabel
				}
			];

			periods.forEach(({
				period,
				dates,
				labelFunc
			}) => {
				metrics.forEach(metric => {
					// Inisialisasi array dengan nilai default 0
					window.chartData[period][metric] = new Array(dates.length).fill(0);

					// Buat listener untuk setiap tanggal dalam periode
					dates.forEach((date, index) => {
						createChartListener(period, dates, metric, index);
					});
				});

				// Render chart awal setelah data dimuat
				setTimeout(() => renderChart(period), 100);
			});
		}

		// Update data chart ketika ada perubahan
		function updateChartData(period, metric, dateIndex, count) {
			if (window.chartData && window.chartData[period] && window.chartData[period][metric]) {
				window.chartData[period][metric][dateIndex] = count;
			}
		}

		// Render chart berdasarkan periode
		function renderChart(period) {
			const dates = getDatesForPeriod(period);
			const labels = formatChartLabels(period, dates);
			const data = window.chartData[period];

			switch (period) {
				case 'daily':
					updateDailyChart(labels, data);
					break;
				case 'weekly':
					updateWeeklyChart(labels, data);
					break;
				case 'monthly':
					updateMonthlyChart(labels, data);
					break;
			}
		}

		// Fungsi utilitas untuk chart
		function getDatesForPeriod(period) {
			const now = new Date();

			switch (period) {
				case 'daily':
					const dailyDates = [];
					for (let i = 6; i >= 0; i--) {
						const date = new Date(now);
						date.setDate(date.getDate() - i);
						dailyDates.push(formatDate(date));
					}
					return dailyDates;

				case 'weekly':
					const weeklyDates = [];
					for (let i = 3; i >= 0; i--) {
						const date = new Date(now);
						date.setDate(date.getDate() - i * 7);
						weeklyDates.push(formatWeek(date));
					}
					return weeklyDates;

				case 'monthly':
					const monthlyDates = [];
					for (let i = 5; i >= 0; i--) {
						const date = new Date(now);
						date.setMonth(date.getMonth() - i);
						monthlyDates.push(formatMonth(date));
					}
					return monthlyDates;

				default:
					return [];
			}
		}

		function formatChartLabels(period, dates) {
			switch (period) {
				case 'daily':
					return dates.map(date => {
						const year = date.substring(0, 4);
						const month = date.substring(4, 6);
						const day = date.substring(6, 8);
						return `${day}/${month}`;
					});

				case 'weekly':
					return dates.map(week => `Minggu ${week.split('W')[1]}`);

				case 'monthly':
					return dates.map(month => {
						const year = month.substring(0, 4);
						const monthNum = month.substring(4, 6);
						const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Ags', 'Sep', 'Okt', 'Nov', 'Des'];
						return `${monthNames[parseInt(monthNum) - 1]} ${year}`;
					});

				default:
					return dates;
			}
		}

		// Fungsi format label yang spesifik (jika diperlukan)
		function formatDailyLabel(date) {
			const year = date.substring(0, 4);
			const month = date.substring(4, 6);
			const day = date.substring(6, 8);
			return `${day}/${month}`;
		}

		function formatWeeklyLabel(week) {
			return `Minggu ${week.split('W')[1]}`;
		}

		function formatMonthlyLabel(month) {
			const year = month.substring(0, 4);
			const monthNum = month.substring(4, 6);
			const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Ags', 'Sep', 'Okt', 'Nov', 'Des'];
			return `${monthNames[parseInt(monthNum) - 1]} ${year}`;
		}

		// Update chart harian
		function updateDailyChart(labels, data) {
			const ctx = document.getElementById('dailyChart').getContext('2d');

			if (dailyChart) {
				dailyChart.destroy();
			}

			dailyChart = new Chart(ctx, {
				type: 'line',
				data: {
					labels: labels,
					datasets: [{
							label: 'Pengguna Baru',
							data: data.new,
							borderColor: '#4cc9f0',
							backgroundColor: 'rgba(76, 201, 240, 0.1)',
							tension: 0.3,
							fill: true
						},
						{
							label: 'Pengguna Online',
							data: data.online,
							borderColor: '#3a0ca3',
							backgroundColor: 'rgba(58, 12, 163, 0.1)',
							tension: 0.3,
							fill: true
						},
						{
							label: 'Pengguna Kembali',
							data: data.returning,
							borderColor: '#f72585',
							backgroundColor: 'rgba(247, 37, 133, 0.1)',
							tension: 0.3,
							fill: true
						}
					]
				},
				options: {
					responsive: true,
					plugins: {
						title: {
							display: true,
							text: 'Statistik Harian (7 Hari Terakhir)'
						},
						legend: {
							position: 'top',
						}
					},
					scales: {
						y: {
							beginAtZero: true,
							ticks: {
								stepSize: 1
							}
						}
					}
				}
			});
		}

		// Update chart mingguan
		function updateWeeklyChart(labels, data) {
			const ctx = document.getElementById('weeklyChart').getContext('2d');

			if (weeklyChart) {
				weeklyChart.destroy();
			}

			weeklyChart = new Chart(ctx, {
				type: 'bar',
				data: {
					labels: labels,
					datasets: [{
							label: 'Pengguna Baru',
							data: data.new,
							backgroundColor: '#4cc9f0'
						},
						{
							label: 'Pengguna Online',
							data: data.online,
							backgroundColor: '#3a0ca3'
						},
						{
							label: 'Pengguna Kembali',
							data: data.returning,
							backgroundColor: '#f72585'
						}
					]
				},
				options: {
					responsive: true,
					plugins: {
						title: {
							display: true,
							text: `Statistik Mingguan (4 Minggu Terakhir)`
						},
						legend: {
							position: 'top',
						}
					},
					scales: {
						y: {
							beginAtZero: true,
							ticks: {
								stepSize: 1
							}
						}
					}
				}
			});
		}

		// Update chart bulanan
		function updateMonthlyChart(labels, data) {
			const ctx = document.getElementById('monthlyChart').getContext('2d');

			if (monthlyChart) {
				monthlyChart.destroy();
			}

			monthlyChart = new Chart(ctx, {
				type: 'line',
				data: {
					labels: labels,
					datasets: [{
							label: 'Pengguna Baru',
							data: data.new,
							borderColor: '#4cc9f0',
							backgroundColor: 'rgba(76, 201, 240, 0.1)',
							tension: 0.3,
							fill: true
						},
						{
							label: 'Pengguna Online',
							data: data.online,
							borderColor: '#3a0ca3',
							backgroundColor: 'rgba(58, 12, 163, 0.1)',
							tension: 0.3,
							fill: true
						},
						{
							label: 'Pengguna Kembali',
							data: data.returning,
							borderColor: '#f72585',
							backgroundColor: 'rgba(247, 37, 133, 0.1)',
							tension: 0.3,
							fill: true
						}
					]
				},
				options: {
					responsive: true,
					plugins: {
						title: {
							display: true,
							text: 'Statistik Bulanan (6 Bulan Terakhir)'
						},
						legend: {
							position: 'top',
						}
					},
					scales: {
						y: {
							beginAtZero: true,
							ticks: {
								stepSize: 1
							}
						}
					}
				}
			});
		}

		// Update chart negara
		function updateCountryChart(countries) {
			const ctx = document.getElementById('countryChart').getContext('2d');

			if (countryChart) {
				countryChart.destroy();
			}

			const labels = countries.map(country => country.code);
			const data = countries.map(country => country.count);
			const backgroundColors = [
				'#4361ee', '#4cc9f0', '#3a0ca3', '#f72585', '#7209b7',
				'#4895ef', '#560bad', '#b5179e', '#f15bb5', '#00bbf9'
			];

			countryChart = new Chart(ctx, {
				type: 'doughnut',
				data: {
					labels: labels,
					datasets: [{
						data: data,
						backgroundColor: backgroundColors
					}]
				},
				options: {
					responsive: true,
					plugins: {
						title: {
							display: true,
							text: 'Top 10 Negara Pengguna'
						},
						legend: {
							position: 'right',
						}
					}
				}
			});
		}

		// Render statistik
		function renderStats() {
			// Update counter untuk setiap periode
			document.getElementById('daily-new').textContent = stats.daily.new;
			document.getElementById('daily-online').textContent = stats.daily.online;
			document.getElementById('daily-returning').textContent = stats.daily.returning;

			document.getElementById('weekly-new').textContent = stats.weekly.new;
			document.getElementById('weekly-online').textContent = stats.weekly.online;
			document.getElementById('weekly-returning').textContent = stats.weekly.returning;

			document.getElementById('monthly-new').textContent = stats.monthly.new;
			document.getElementById('monthly-online').textContent = stats.monthly.online;
			document.getElementById('monthly-returning').textContent = stats.monthly.returning;

		}

		// Render daftar pengguna
		function renderUsers() {
			const totalUser = document.getElementById('total-user-count');
			const usersListElement = document.getElementById('users-list');
			const showOfflineToggle = document.getElementById('show-offline');
			const showOffline = showOfflineToggle.checked;


			usersListElement.innerHTML = '';

			const filteredUsers = showOffline ? users : users.filter(user => user.status !== 'offline');

			if (filteredUsers.length === 0) {
				usersListElement.innerHTML = '<div class="text-center p-3 text-muted">Tidak ada pengguna online</div>';
				return;
			}

			totalUser.textContent = `${stats.total.unique}`;

			filteredUsers.forEach(user => {
				const userItem = document.createElement('div');
				userItem.className = 'list-group-item user-item';
				userItem.dataset.userId = user.id;

				const lastSeenText = user.status === 'offline' ?
					`<span class="last-seen">• ${formatLastSeen(user.lastSeen)}</span>` : '';

				userItem.innerHTML = `
							<div class="d-flex">
								<div class="d-flex align-items-center flex-grow-1">
									<img src="https://flagcdn.com/w20/${user.countryCode.toLowerCase()}.png" 
										class="country-flag me-2" alt="${user.countryCode}" 
										onerror="this.style.display='none'">
									<span class="user-uid">${user.id}</span>
								</div>
								<div class="d-flex flex-column align-items-end" style="width: 100px; gap:10px">
									<span class="badge bg-${getStatusColor(user.status)} me-2" style="width:50px">${user.status}</span>
									<span class="last-seen">${lastSeenText}</span>							
								</div>
							</div>
						`;

				userItem.addEventListener('click', () => showUserDetails(user.id));
				usersListElement.appendChild(userItem);
			});
		}

		// Tampilkan detail pengguna 
		async function showUserDetails(userId) {
			const appPath = `globalWebAnalytics/apps/${currentAppId}`;
			const userRef = ref(database, `${appPath}/users/${userId}`);

			try {
				const snapshot = await get(userRef);

				if (snapshot.exists()) {
					const userData = snapshot.val();
					const userPresence = userData.UserPresence || {};
					const ipHistory = userData.IPHistory || {};
					const uidHistory = userData.FirebaseUIDHistory || {};

					// Format data untuk ditampilkan
					const userDetails = {
						id: userId,
						status: userPresence.status || "unknown",
						lastSeen: formatLastSeen(userPresence.userLastSeen || 0),
						countryCode: userPresence.countryCode || "unknown",
						lastIP: userPresence.LastIP || "unknown",
						lastFirebaseUID: userPresence.LastFirebaseUID || "unknown",
						ipHistory: Object.keys(ipHistory).map(ip => ({
							ip: ip,
							countryCode: ipHistory[ip].countryCode || "unknown",
							timestamp: formatTimestamp(ipHistory[ip].timestamp || 0)
						})),
						uidHistory: Object.keys(uidHistory).map(uid => ({
							uid: uid,
							timestamp: formatTimestamp(uidHistory[uid].timestamp || 0)
						}))
					};

					// Tampilkan modal dengan detail pengguna
					showUserModal(userDetails);
				}
			} catch (error) {
				console.error('Error memuat detail pengguna:', error);
			}
		}

		// Tampilkan modal dengan detail pengguna
		function showUserModal(userDetails) {
			// Hapus modal sebelumnya jika ada
			const existingModal = document.getElementById('userModal');
			if (existingModal) {
				existingModal.remove();
			}

			// Buat modal HTML
			const modalHTML = `
						<div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
							<div class="modal-dialog modal-lg">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="userModalLabel">Detail Pengguna: ${userDetails.id}</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<div class="row mb-3">
											<div class="col-md-6">
												<strong>Status:</strong> 
												<span class="badge bg-${getStatusColor(userDetails.status)}">${userDetails.status}</span>
											</div>
											<div class="col-md-6">
												<strong>Terakhir Dilihat:</strong> ${userDetails.lastSeen}
											</div>
										</div>
										<div class="row mb-3">
											<div class="col-md-6">
												<strong>Negara:</strong> 
												<img src="https://flagcdn.com/w20/${userDetails.countryCode.toLowerCase()}.png" 
													 class="country-flag ms-1" alt="${userDetails.countryCode}" 
													 onerror="this.style.display='none'">
												${userDetails.countryCode}
											</div>
											<div class="col-md-6">
												<strong>IP Terakhir:</strong> ${userDetails.lastIP}
											</div>
										</div>
										
										<div class="mb-3">
											<h6>Riwayat IP</h6>
											<div class="table-responsive">
												<table class="table table-sm">
													<thead>
														<tr>
															<th>IP</th>
															<th>Negara</th>
															<th>Waktu</th>
														</tr>
													</thead>
													<tbody>
														${userDetails.ipHistory.map(ip => `
															<tr>
																<td>${ip.ip}</td>
																<td>
																	<img src="https://flagcdn.com/w20/${ip.countryCode.toLowerCase()}.png" 
																		 class="country-flag me-1" alt="${ip.countryCode}" 
																		 onerror="this.style.display='none'">
																	${ip.countryCode}
																</td>
																<td>${ip.timestamp}</td>
															</tr>
														`).join('')}
													</tbody>
												</table>
											</div>
										</div>
										
										<div class="mb-3">
											<h6>Riwayat Firebase UID</h6>
											<div class="table-responsive">
												<table class="table table-sm">
													<thead>
														<tr>
															<th>UID</th>
															<th>Waktu</th>
														</tr>
													</thead>
													<tbody>
														${userDetails.uidHistory.map(uid => `
															<tr>
																<td><code>${uid.uid}</code></td>
																<td>${uid.timestamp}</td>
															</tr>
														`).join('')}
													</tbody>
												</table>
											</div>
										</div>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
									</div>
								</div>
							</div>
						</div>
					`;

			// Tambahkan modal ke body
			document.body.insertAdjacentHTML('beforeend', modalHTML);

			// Tampilkan modal
			const userModal = new bootstrap.Modal(document.getElementById('userModal'));
			userModal.show();

			// Hapus modal dari DOM setelah ditutup
			document.getElementById('userModal').addEventListener('hidden.bs.modal', function () {
				this.remove();
			});
		}

		// Fungsi utilitas
		function formatDate(date) {
			return `${date.getFullYear()}${String(date.getMonth() + 1).padStart(2, "0")}${String(date.getDate()).padStart(2, "0")}`;
		}

		function formatWeek(date) {
			const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
			const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
			const weekNumber = Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
			return `${date.getFullYear()}W${String(weekNumber).padStart(2, "0")}`;
		}

		function formatMonth(date) {
			return `${date.getFullYear()}${String(date.getMonth() + 1).padStart(2, "0")}`;
		}

		// Fungsi untuk memformat angka
		function formatNumber(num) {
			if (num >= 1000000) {
				return (num / 1000000).toFixed(1) + 'M';
			}
			if (num >= 1000) {
				return (num / 1000).toFixed(1) + 'K';
			}
			return num;
		}

		function formatLastSeen(timestamp) {
			if (!timestamp) return 'Tidak diketahui';

			const now = Date.now();
			const diffMs = now - timestamp;
			const diffMins = Math.floor(diffMs / 60000);
			const diffHours = Math.floor(diffMs / 3600000);
			const diffDays = Math.floor(diffMs / 86400000);

			if (diffMins < 1) return 'Baru saja';
			if (diffMins < 60) return `${diffMins} menit lalu`;
			if (diffHours < 24) return `${diffHours} jam lalu`;
			return `${diffDays} hari lalu`;
		}

		function formatTimestamp(timestamp) {
			if (!timestamp) return 'Tidak diketahui';
			return new Date(timestamp).toLocaleString('id-ID');
		}

		function getStatusColor(status) {
			switch (status) {
				case 'online':
					return 'success';
				case 'idle':
					return 'warning';
				case 'offline':
					return 'secondary';
				default:
					return 'secondary';
			}
		}

		// Event listeners
		document.getElementById('show-offline').addEventListener('change', renderUsers);

		// Inisialisasi dashboard
		document.addEventListener('DOMContentLoaded', () => {
			loadAppsList();
		});
    </script>
</body>
</html>
