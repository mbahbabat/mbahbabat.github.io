function isIndonesia(e){if("ID"===e.country_code2)return!0;if("IDN"===e.country_code3)return!0;if("+62"===e.calling_code)return!0;if(e.currency&&"IDR"===e.currency.code)return!0;if(e.languages&&e.languages.includes("id"))return!0;if(e.time_zone){if(["Asia/Jakarta","Asia/Makassar","Asia/Jayapura"].includes(e.time_zone.name))return!0;if([7,8,9].includes(e.time_zone.offset))return!0}if(e.isp||e.organization){const o=(e.isp||e.organization||"").toLowerCase();if(["indonesia","telkom","telkomsel","xl","axis","indosat","smartfren","tri","bolt","by.u","kartu","simpati","mentari"].some((e=>o.includes(e))))return!0}return!1}async function fetchLocInfoWithTimeout(e,o=5e3){const t=new AbortController,n=setTimeout((()=>t.abort()),o);try{const o=await fetch(e,{signal:t.signal});return clearTimeout(n),o}catch(e){throw clearTimeout(n),e}}async function locInfo(){const e=["1874cf82555e4b0a92757d43d75644d2","4df5b64e9f204b559e96dc3b6dd4a86b","482673d945c5418ba9327d5040870cd9","136eedb47fb14865a50c4b56843723d5","00adbd6bdf9641528ed76495c14cf000","11e9c42d7dba4031a0f7c3a27e78b5d3","ed21430487dc4042b7c874754a7375fb","19e8d406be0b4d0cbdd5f4d1cd4efc78"];for(const o of e){const e=`https://api.ipgeolocation.io/ipgeo?apiKey=${o}`;try{const o=await fetchLocInfoWithTimeout(e,5e3);if(!o.ok)throw new Error(`HTTP ${o.status}`);const t=await o.json(),n=isIndonesia(t);return{ip:(t.ip||"Unknown").toLowerCase(),country:(t.country_name||"Unknown").toLowerCase(),region:t.state_prov?t.state_prov.toLowerCase():"unknown",city:(t.city||"Unknown").toLowerCase(),code:t.country_code2||"Unknown",isFromIndonesia:n,rawData:{calling_code:t.calling_code,currency:t.currency,languages:t.languages,time_zone:t.time_zone,isp:t.isp,organization:t.organization}}}catch(e){console.warn(`API key ${o.slice(0,8)}... failed:`,e.message)}}return{ip:"unknown",country:"unknown",region:"unknown",city:"unknown",code:"unknown",isFromIndonesia:!1,rawData:null}}function showLanguageConfirmationPopup(e){window.location.pathname;let o="",t="";const{isLangID:n,apiDocsSite:a,executeSite:i,isHomeSite:r,assetsBasePath:s}=getAssetsBasePath();if("id"===e?(o="Sistem kami mendeteksi lokasi Anda sepertinya dari Indonesia. Apakah Anda ingin beralih ke situs versi Bahasa Indonesia?",a?t="https://mbahbabat.github.io/bulk-gmail-checker/id/api-docs/":i?t="https://mbahbabat.github.io/bulk-gmail-checker/id/execute/":r&&(t="https://mbahbabat.github.io/bulk-gmail-checker/id/")):(o="Our system has detected that your location appears to be outside of Indonesia. Would you like to switch to the English version of the site?",a?t="https://mbahbabat.github.io/bulk-gmail-checker/api-docs/":i?t="https://mbahbabat.github.io/bulk-gmail-checker/execute/":r&&(t="https://mbahbabat.github.io/bulk-gmail-checker/")),document.getElementById("lang-redirect-popup"))return;const c=document.createElement("div");c.id="lang-redirect-popup",c.innerHTML=` <div class="popup-content"> <span>${o}</span> <div class="popup-buttons"> <button id="popup-yes">${"id"===e?"Ya":"Yes"}</button> <button id="popup-no">${"id"===e?"Tidak":"No"}</button> </div> </div> `;const u=document.createElement("style");function d(e){e.style.opacity="0",e.style.top="-200px",setTimeout((()=>e.remove()),500)}u.textContent="#lang-redirect-popup { position: fixed; top: -200px; left: 50%; transform: translateX(-50%); background: white; color: black; padding: 10px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); text-align: center; transition: top 1s ease, opacity 1s ease; opacity: 0; z-index: 10002; width: 95%; } @media(min-width:1025px){ #lang-redirect-popup{ max-width: 55rem; } } #lang-redirect-popup.show{ top: 30px; opacity: 1; } .popup-buttons { display: flex; justify-content: center; gap: 0.75rem; margin-top: 0.938rem; } .popup-buttons button { width: 3.5rem; height: 1.75rem; border: none; border-radius: 6px; cursor: pointer; font-size: 0.813rem; font-weight: 500; transition: all 0.25s ease; } #popup-yes { background-color: #4CAF50; color: #fff; } #popup-yes:hover { background-color: #45a049; transform: translateY(-1px); } #popup-no { background-color: #f44336; color: #fff; } #popup-no:hover { background-color: #d32f2f; transform: translateY(-1px); } ",document.head.appendChild(u),document.body.appendChild(c),setTimeout((()=>c.classList.add("show")),50),c.querySelector("#popup-yes").onclick=()=>{d(c),window.location.href=t},c.querySelector("#popup-no").onclick=()=>{d(c)}}(async()=>{try{const e=(await locInfo()).isFromIndonesia,o=window.location.pathname.includes("/id/");setTimeout((()=>{e&&!o?showLanguageConfirmationPopup("id"):!e&&o&&showLanguageConfirmationPopup("en")}),5e3)}catch(e){console.error("Error in language detection or popup logic:",e)}})();