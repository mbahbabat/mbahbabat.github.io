let results=[],currentFilter="all";const ITEM_HEIGHT_REM=2.1875,OVERSCAN=10;let resultVirtualScrollTimer,startIndex=0,endIndex=0;function getCurrentRemValue(){return parseFloat(getComputedStyle(document.documentElement).fontSize)}function remToPx(t){return t*getCurrentRemValue()}function debounce(t,e){let n;return function(...l){const r=this;clearTimeout(n),n=setTimeout((()=>t.apply(r,l)),e)}}function calculateVisibleItems(){const t=resultListContainer.scrollTop,e=resultListContainer.clientHeight,n=remToPx(ITEM_HEIGHT_REM),l="all"===currentFilter?results:results.filter((t=>t.status===currentFilter)),r=l.length;startIndex=Math.max(0,Math.floor(t/n)-OVERSCAN),endIndex=Math.min(r-1,Math.ceil((t+e)/n)+OVERSCAN);return{startIndex:startIndex,endIndex:endIndex,paddingTop:startIndex*ITEM_HEIGHT_REM,paddingBottom:(r-1-endIndex)*ITEM_HEIGHT_REM,totalItems:r,filteredResults:l,itemHeightPx:n}}function handleScroll(){resultVirtualScrollTimer&&clearTimeout(resultVirtualScrollTimer),resultVirtualScrollTimer=setTimeout(displayResults,50)}function displayResults(){const{startIndex:t,endIndex:e,paddingTop:n,paddingBottom:l,totalItems:r,filteredResults:s}=calculateVisibleItems();if(resultList.innerHTML="",0===r)return void(isLangID?resultList.innerHTML="<p>Tidak ada hasil ditemukan untuk filter ini.</p>":resultList.innerHTML="<p>No results found for this filter.</p>");const i=document.createElement("div");i.style.height=`${n}rem`,resultList.appendChild(i);for(let n=t;n<=e;n++){const t=s[n];if(!t)continue;const e=document.createElement("div");e.className="result-item",e.style.height=`${ITEM_HEIGHT_REM}rem`,e.style.display="flex",e.style.alignItems="center",e.style.gap="0.5rem";const l=document.createElement("span");l.textContent=`${n+1}`,l.style.cssText="min-width: 1.5625rem; text-align: right; display: inline-block; pointer-events: none; user-select: none;",l.classList.add("number-prefix");const r=document.createElement("span");let i=t.email;r.classList.add(`status-${t.status}`),"all"===currentFilter&&(i+=` - ${t.status.charAt(0).toUpperCase()+t.status.slice(1)}`),r.textContent=i,r.style.flexGrow="1",r.style.overflow="hidden",r.style.textOverflow="ellipsis",r.style.whiteSpace="nowrap",e.appendChild(l),e.appendChild(r),resultList.appendChild(e)}const a=document.createElement("div");a.style.height=`${l}rem`,resultList.appendChild(a),resultList.style.height=r*ITEM_HEIGHT_REM+"rem"}function initVirtualScroll(){resultListContainer&&(resultListContainer.style.overflowY="auto",resultListContainer.style.position="relative",resultList.innerHTML="",displayResults(),resultListContainer.addEventListener("scroll",handleScroll),window.RDS&&window.addEventListener("resize",handleScroll))}function updateCounters(){blockUpdateMessages(!0);const t=results.length,e=results.filter((t=>"live"===t.status)).length,n=results.filter((t=>"verify"===t.status)).length,l=results.filter((t=>"disabled"===t.status)).length,r=results.filter((t=>"unregistered"===t.status)).length,s=results.filter((t=>"bad"===t.status)).length;countAll.textContent=`(${t})`,countLive.textContent=`(${e})`,countVer.textContent=`(${n})`,countDisabled.textContent=`(${l})`,countUnregistered.textContent=`(${r})`,countBad.textContent=`(${s})`}function copyResults(){const t="all"===currentFilter?results:results.filter((t=>t.status===currentFilter));if(0===t.length)return void alert("No results to copy.");let e;e="all"===currentFilter?t.map((t=>`${t.email} - ${t.status.charAt(0).toUpperCase()+t.status.slice(1)}`)).join("\n"):t.map((t=>t.email)).join("\n"),navigator.clipboard.writeText(e).then((()=>{const t=copyBtn.innerHTML;isLangID?copyBtn.innerHTML='<p><i class="fas fa-check"></i> TERSALIN!</p>':copyBtn.innerHTML='<p><i class="fas fa-check"></i> COPIED!</p>',copyBtn.style.backgroundColor="var(--secondary-orange)",setTimeout((()=>{copyBtn.innerHTML=t,copyBtn.style.backgroundColor=""}),2e3)})).catch((t=>{console.error("Failed to copy: ",t),alert("Failed to copy results to clipboard.")}))}function downloadResults(){const t="all"===currentFilter?results:results.filter((t=>t.status===currentFilter));if(0===t.length)return void alert("No results to download.");let e;e="all"===currentFilter?t.map((t=>`${t.email} - ${t.status.charAt(0).toUpperCase()+t.status.slice(1)}`)).join("\n"):t.map((t=>t.email)).join("\n");const n=new Date,l=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}_${String(n.getHours()).padStart(2,"0")}-${String(n.getMinutes()).padStart(2,"0")}-${String(n.getSeconds()).padStart(2,"0")}`,r=t.length,s=new Blob([e],{type:"text/plain"}),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i,a.download=`${currentFilter.toUpperCase()}-${r}-Gmails-BulkGmailChecker_${l}.txt`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initVirtualScroll):initVirtualScroll();