let invalidEmails=[],validEmails=[];function inputLineNumbersScroll(){lineNumbers.scrollTop=emailInput.scrollTop}function updateInputLineNumbers(){const e=emailInput.value.split("\n").length;if(e>2e3)return textareaContainer.style.cssText="flex-direction: column",lineNumbers.style.cssText="height: 50px;align-items: center;justify-content: center;padding:10px;margin:0;border: 1px solid red",void(lineNumbers.innerHTML=`<div style="font-size: 1.2em; color: #fff; font-style: italic; animation: blink-animation 2s infinite">\n\t\t\t\t\t\tTOTAL: <strong style="font-weight; bold"> ${e} </strong>EMAILS\n\t\t\t\t\t</div>`);textareaContainer.style.cssText="",lineNumbers.style.cssText="",lineNumbers.innerHTML="";for(let t=1;t<=e;t++){const e=document.createElement("div");e.textContent=t,lineNumbers.appendChild(e)}}function handlePaste(){navigator.clipboard.readText().then((e=>{emailInput.value=e,updateInputLineNumbers()})).catch((e=>{console.error("Failed to read clipboard contents: ",e),alert("Failed to paste from clipboard. Please paste manually.")}))}function handleFileUpload(e){const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=function(e){emailInput.value=e.target.result,updateInputLineNumbers(),fileInput.value=""},n.readAsText(t)}function clearInput(){emailInput.value="",validateInput(),updateInputLineNumbers()}function validateInput(){let e=emailInput.value.split("\n"),t=new Set;invalidEmails=[],validEmails=[],e.forEach(((e,n)=>{const a=n+1,i=/([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)/gi;let l,s=0;for(;null!==(l=i.exec(e));){const n=e.substring(s,l.index).trim();n.length>0&&invalidEmails.push({lineNumber:a,text:n,message:"Not a valid email format",color:"#ff3399"});let r=l[0].trim();if(s=i.lastIndex,0===r.length)continue;const o=/@gmail\.com$/i;if(!/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+)@([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)$/.test(r)){invalidEmails.push({lineNumber:a,text:r,message:"Invalid email format",color:"#ff3399"});continue}const d=r.split("@")[0];if(/[^a-zA-Z0-9._-]/.test(d))invalidEmails.push({lineNumber:a,text:r,message:"Contains invalid characters in local part",color:"#ffaa00"});else if(o.test(r))t.has(r.toLowerCase())?invalidEmails.push({lineNumber:a,text:r,message:"Duplicate email",color:"#00ffff"}):(validEmails.push(r),t.add(r.toLowerCase()));else{const e=r.split("@")[1];invalidEmails.push({lineNumber:a,text:r,message:`Wrong domain: ${e}`,color:"#9900ff"})}}const r=e.substring(s).trim();r.length>0&&invalidEmails.push({lineNumber:a,text:r,message:"Not a valid email format",color:"#ff3399"})})),validEmails.length>=1&&0===invalidEmails.length&&!systemMessageBlocked?executeBtn.style.cssText="animation: blink-animation 1s infinite":executeBtn.style.cssText="",displayErrors()}function toggleErrorBtn(){invalidEmails.length>0?(executeBtn.disabled=!0,pasteBtn.disabled=!0,uploadBtn.disabled=!0,clearInputBtn.classList.add("hidden"),clearErrorsBtn.classList.remove("hidden")):(executeBtn.disabled=!1,pasteBtn.disabled=!1,uploadBtn.disabled=!1,clearInputBtn.classList.remove("hidden"),clearErrorsBtn.classList.add("hidden"))}let messageInterval=null;function displayErrors(){if(!systemMessageBlocked)if(messageInterval&&(clearInterval(messageInterval),messageInterval=null),toggleErrorBtn(),errorList.innerHTML="",invalidEmails.length>0)errorInfo.classList.remove("hidden"),systemMessage.textContent=`${invalidEmails.length} invalid emails detected`,invalidEmails.forEach((e=>{const t=document.createElement("p"),n=document.createTextNode(`Line ${e.lineNumber}: ${e.text} - `);t.appendChild(n);const a=document.createElement("span");a.style.color=e.color,a.textContent=e.message,t.appendChild(a),errorList.appendChild(t)}));else{errorList.innerHTML="",errorInfo.classList.add("hidden");if(0===emailInput.value.trim().length)return void(systemMessage.textContent="ENTER AT LEAST 1 VALID EMAIL ADDRESS");messageInterval=setInterval((()=>{systemMessageBlocked||(systemMessage.innerHTML='<p><i class="fa-solid fa-circle-exclamation"></i> CAUTION :</p><p>"This application is still under development;</p><p>please contact @mbahbabat if you find any bugs."</p>',systemMessage.style.cssText="font-size: 0.8em;animation: blink-animation 3s infinite alternate ease-in-out; color: #ffff00;font-style:italic")}),5e3)}}async function clearErrors(){emailInput.value=validEmails.join("\n"),invalidEmails=[],errorList.innerHTML="",toggleErrorBtn(),validateInput(),updateInputLineNumbers()}