let results=[],currentFilter="all";const ITEM_HEIGHT_REM=2.1875,OVERSCAN=10;let resultVirtualScrollTimer,startIndex=0,endIndex=0;function getCurrentRemValue(){return parseFloat(getComputedStyle(document.documentElement).fontSize)}function remToPx(t){return t*getCurrentRemValue()}function debounce(t,e){let l;return function(...n){const r=this;clearTimeout(l),l=setTimeout((()=>t.apply(r,n)),e)}}function calculateVisibleItems(){const t=resultListContainer.scrollTop,e=resultListContainer.clientHeight,l=remToPx(ITEM_HEIGHT_REM),n="all"===currentFilter?results:results.filter((t=>t.status===currentFilter)),r=n.length;startIndex=Math.max(0,Math.floor(t/l)-OVERSCAN),endIndex=Math.min(r-1,Math.ceil((t+e)/l)+OVERSCAN);return{startIndex:startIndex,endIndex:endIndex,paddingTop:startIndex*ITEM_HEIGHT_REM,paddingBottom:(r-1-endIndex)*ITEM_HEIGHT_REM,totalItems:r,filteredResults:n,itemHeightPx:l}}function handleScroll(){resultVirtualScrollTimer&&clearTimeout(resultVirtualScrollTimer),resultVirtualScrollTimer=setTimeout(displayResults,50)}function displayResults(){blockUpdateMessages(!0);const{startIndex:t,endIndex:e,paddingTop:l,paddingBottom:n,totalItems:r,filteredResults:s}=calculateVisibleItems();if(resultList.innerHTML="",0===r)return void(resultList.innerHTML="<p>No results found for this filter.</p>");const i=document.createElement("div");i.style.height=`${l}rem`,resultList.appendChild(i);for(let l=t;l<=e;l++){const t=s[l];if(!t)continue;const e=document.createElement("div");e.className="result-item",e.style.height=`${ITEM_HEIGHT_REM}rem`,e.style.display="flex",e.style.alignItems="center",e.style.gap="0.5rem";const n=document.createElement("span");n.textContent=`${l+1}`,n.style.cssText="min-width: 1.5625rem; text-align: right; display: inline-block; pointer-events: none; user-select: none;",n.classList.add("number-prefix");const r=document.createElement("span");let i=t.email;r.classList.add(`status-${t.status}`),"all"===currentFilter&&(i+=` - ${t.status.charAt(0).toUpperCase()+t.status.slice(1)}`),r.textContent=i,r.style.flexGrow="1",r.style.overflow="hidden",r.style.textOverflow="ellipsis",r.style.whiteSpace="nowrap",e.appendChild(n),e.appendChild(r),resultList.appendChild(e)}const o=document.createElement("div");o.style.height=`${n}rem`,resultList.appendChild(o),resultList.style.height=r*ITEM_HEIGHT_REM+"rem"}function initVirtualScroll(){resultListContainer&&(resultListContainer.style.overflowY="auto",resultListContainer.style.position="relative",resultList.innerHTML="",displayResults(),resultListContainer.addEventListener("scroll",handleScroll),window.RDS&&window.addEventListener("resize",handleScroll))}function updateCounters(){blockUpdateMessages(!0);const t=results.length,e=results.filter((t=>"live"===t.status)).length,l=results.filter((t=>"verify"===t.status)).length,n=results.filter((t=>"disabled"===t.status)).length,r=results.filter((t=>"unregistered"===t.status)).length,s=results.filter((t=>"error"===t.status)).length;countAll.textContent=`(${t})`,countLive.textContent=`(${e})`,countVer.textContent=`(${l})`,countDisabled.textContent=`(${n})`,countUnregistered.textContent=`(${r})`,countError.textContent=`(${s})`}function copyResults(){const t="all"===currentFilter?results:results.filter((t=>t.status===currentFilter));if(0===t.length)return void alert("No results to copy.");let e;e="all"===currentFilter?t.map((t=>`${t.email} - ${t.status.charAt(0).toUpperCase()+t.status.slice(1)}`)).join("\n"):t.map((t=>t.email)).join("\n"),navigator.clipboard.writeText(e).then((()=>{alert("Results copied to clipboard!")})).catch((t=>{console.error("Failed to copy: ",t),alert("Failed to copy results to clipboard.")}))}function downloadResults(){const t="all"===currentFilter?results:results.filter((t=>t.status===currentFilter));if(0===t.length)return void alert("No results to download.");let e;e="all"===currentFilter?t.map((t=>`${t.email} - ${t.status.charAt(0).toUpperCase()+t.status.slice(1)}`)).join("\n"):t.map((t=>t.email)).join("\n");const l=new Date,n=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}_${String(l.getHours()).padStart(2,"0")}-${String(l.getMinutes()).padStart(2,"0")}-${String(l.getSeconds()).padStart(2,"0")}`,r=t.length,s=new Blob([e],{type:"text/plain"}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=`${currentFilter.toUpperCase()}-${r}-Gmails-BulkGmailChecker_${n}.txt`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initVirtualScroll):initVirtualScroll();